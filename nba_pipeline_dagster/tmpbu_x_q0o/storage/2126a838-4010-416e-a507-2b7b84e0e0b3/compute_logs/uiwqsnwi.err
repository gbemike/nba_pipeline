[32m2024-04-03 20:53:04 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 2126a838-4010-416e-a507-2b7b84e0e0b3 - 1016871 - LOGS_CAPTURED - Started capturing logs in process (pid: 1016871).
[32m2024-04-03 20:53:04 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 2126a838-4010-416e-a507-2b7b84e0e0b3 - 1016871 - nba_pipeline_dbt_assets - STEP_START - Started execution of step "nba_pipeline_dbt_assets".
[32m2024-04-03 20:53:04 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 2126a838-4010-416e-a507-2b7b84e0e0b3 - nba_pipeline_dbt_assets - A dbt subsetted execution is being performed. Overriding default dbt selection arguments `['--select', 'fqn:*']` with arguments: `['--select', 'fqn:nba_pipeline.staging.stg_player_bio']`
[32m2024-04-03 20:53:04 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 2126a838-4010-416e-a507-2b7b84e0e0b3 - nba_pipeline_dbt_assets - Copying `/home/gbemike/Documents/github/nba_pipeline/target/partial_parse.msgpack` to `/home/gbemike/Documents/github/nba_pipeline/target/nba_pipeline_dbt_assets-2126a83-38300a8/partial_parse.msgpack` to take advantage of partial parsing.
[32m2024-04-03 20:53:04 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 2126a838-4010-416e-a507-2b7b84e0e0b3 - nba_pipeline_dbt_assets - Running dbt command: `dbt build --select fqn:nba_pipeline.staging.stg_player_bio`.
[32m2024-04-03 20:53:13 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 2126a838-4010-416e-a507-2b7b84e0e0b3 - 1016871 - nba_pipeline_dbt_assets - STEP_OUTPUT - Yielded output "model_nba_pipeline_stg_player_bio" of type "Nothing". (Type check passed).
[32m2024-04-03 20:53:13 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 2126a838-4010-416e-a507-2b7b84e0e0b3 - 1016871 - nba_pipeline_dbt_assets - ASSET_MATERIALIZATION - Materialized value stg_player_bio.
Exception ignored in: <generator object DbtCliInvocation.stream_raw_events at 0x7fee3636bb00>
Traceback (most recent call last):
  File "/home/gbemike/Documents/github/nba_pipeline/.venv/lib/python3.11/site-packages/dagster_dbt/core/resources_v2.py", line 453, in stream
    yield from event.to_default_asset_events(
RuntimeError: generator ignored GeneratorExit
[32m2024-04-03 20:53:19 +0000[0m - dagster - [34mERROR[0m - [31m__ASSET_JOB - 2126a838-4010-416e-a507-2b7b84e0e0b3 - 1016871 - nba_pipeline_dbt_assets - STEP_FAILURE - Execution of step "nba_pipeline_dbt_assets" failed.

dagster._core.errors.DagsterExecutionStepExecutionError: Error occurred while executing op "nba_pipeline_dbt_assets"::

KeyError: 'test.nba_pipeline.not_null_stg_player_bio_player_name.16d2db59f0'

Stack Trace:
  File "/home/gbemike/Documents/github/nba_pipeline/.venv/lib/python3.11/site-packages/dagster/_core/execution/plan/utils.py", line 54, in op_execution_error_boundary
    yield
  File "/home/gbemike/Documents/github/nba_pipeline/.venv/lib/python3.11/site-packages/dagster/_utils/__init__.py", line 463, in iterate_with_context
    next_output = next(iterator)
                  ^^^^^^^^^^^^^^
  File "/home/gbemike/Documents/github/nba_pipeline/nba_pipeline_dagster/nba_pipeline_dagster/assets.py", line 21, in nba_pipeline_dbt_assets
    yield from dbt.cli(["build"], context=context).stream()
  File "/home/gbemike/Documents/github/nba_pipeline/.venv/lib/python3.11/site-packages/dagster_dbt/core/resources_v2.py", line 453, in stream
    yield from event.to_default_asset_events(
  File "/home/gbemike/Documents/github/nba_pipeline/.venv/lib/python3.11/site-packages/dagster_dbt/core/resources_v2.py", line 152, in to_default_asset_events
    dbt_resource_props = manifest["nodes"][unique_id]
                         ~~~~~~~~~~~~~~~~~^^^^^^^^^^^
[0m
